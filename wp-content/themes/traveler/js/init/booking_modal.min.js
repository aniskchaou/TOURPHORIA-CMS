jQuery(document).ready(function(a){function t(t){var e=a(t+"  .booking-item-payment");e.find(".overlay-form").show(),a.ajax({type:"post",dataType:"json",url:st_params.ajax_url,data:{action:"modal_get_cart_detail"},success:function(a){e.html(a),e.find(".overlay-form").hide()},error:function(a){e.find(".overlay-form").hide()}})}function e(t,e,r){void 0===r&&(r="infomation");var o='<div class="alert alert-'+r+'">'+e+"</div>";t.length&&(t.html(""),t.html(o),console.log(t.offset().top),console.log(a(window).height()),t.offset().top>a(window).height()&&function(t){if(t.length){var e=t.offset().top;a("#wpadminbar").length&&"fixed"==a("#wpadminbar").css("position")&&(e-=32),e-=300,a("html,body").animate({scrollTop:e},500)}}(t))}function r(a){var t=a.find(".captcha_box");url=t.find(".captcha_img").attr("src"),t.find(".captcha_img").attr("src",url)}var o=!1;a(document).on("click",".btn-st-add-cart",function(){for(var r=a(this),n=r.closest("form"),i=[],s=a(".message_box"),d=n.serializeArray(),l=0;l<d.length;l++)i.push({name:d[l].name,value:d[l].value});i.push({name:"action",value:"st_add_to_cart"});for(var c={},l=0;l<i.length;++l)c[i[l].name]=i[l].value;r.addClass("loading"),s.html(""),a.ajax({type:"post",dataType:"json",url:st_params.ajax_url,data:c,success:function(n){r.removeClass("loading"),n.message&&e(s,n.message,"danger"),n.status&&(a.magnificPopup.open({items:{type:"inline",src:r.data("target")},close:function(){o=!1}}),t(r.data("target")))},error:function(a){r.removeClass("loading")}})}),a(".btn-st-show-cart-modal").click(function(){var e=a(this);a.magnificPopup.open({items:{type:"inline",src:e.data("target")},close:function(){o=!1}}),t(e.data("target"))}),a(document).on("click",".booking_modal_form .btn-st-checkout-submit",function(){var t=a(this).closest("form");t.trigger("st_before_checkout_modal");var e=a('input[name="st_payment_gateway"]:checked',t).val();if("wait"===a('input[name="wait_validate_'+e+'"]',t).val())return t.trigger("st_wait_checkout_modal"),!1;t.STSendModalBookingAjax()}),function(a){a.fn.STSendModalBookingAjax=function(){this.each(function(){var t=a(this),e=a(".btn-st-checkout-submit",this),n=t.serializeArray();n.push({name:"action",value:"booking_form_direct_submit"}),t.find(".form-control").removeClass("error"),t.find(".form_alert").addClass("hidden");for(var i={},s=!0,d=0;d<n.length;++d)i[n[d].name]=n[d].value;return a("input.required,select.required,textarea.required",t).removeClass("error"),a("input.required,select.required,textarea.required",t).each(function(){a(this).val()||(a(this).addClass("error"),s=!1)}),0==s?(t.find(".form_alert").addClass("alert-danger").removeClass("hidden"),t.find(".form_alert").html(st_checkout_text.validate_form),!1):i.term_condition?(i.order_id=o,e.addClass("loading"),void a.ajax({type:"post",dataType:"json",url:st_params.ajax_url,data:i,success:function(n){e.removeClass("loading"),n.message&&(t.find(".form_alert").addClass("alert-danger").removeClass("hidden"),t.find(".form_alert").html(n.message)),n.redirect&&(window.location.href=n.redirect),n.redirect_form&&a("body").append(n.redirect_form),void 0!==n.order_id&&n.order_id&&(o=n.order_id),n.new_nonce;i.item_id;r(t)},error:function(a){alert("Ajax Fail");i.item_id;r(t),e.removeClass("loading")}})):(t.find(".form_alert").addClass("alert-danger").removeClass("hidden"),t.find(".form_alert").html(st_checkout_text.error_accept_term),!1)})}}(jQuery),a(".payment-item-radio").on("ifChecked",function(){var t=a(this).closest("li.payment-gateway");id=t.data("gateway"),t.addClass("active").siblings().removeClass("active"),a('.st-payment-tab-content .st-tab-content[data-id="'+id+'"]').siblings().fadeOut("fast"),a('.st-payment-tab-content .st-tab-content[data-id="'+id+'"]').fadeIn("fast")})});