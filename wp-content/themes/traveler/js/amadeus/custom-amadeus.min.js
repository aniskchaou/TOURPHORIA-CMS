jQuery(document).ready(function(a){"use strict";var t="";a(".input-daterange .amd_depart_date").each(function(){var e=a(this).closest("form"),s=a(this).parent();a(this);a(this).datepicker({language:st_params.locale,autoclose:!0,todayHighlight:!0,startDate:"today",format:s.data("tp-date-format"),weekStart:1}).on("changeDate",function(t){var n=t.date.getMonth()+1;t.date.getMonth()+1<10&&(n="0"+n);var r=t.date.getDate();t.date.getDate()<10&&(r="0"+r),a(this).parent().find(".amd-date-from").val(t.date.getFullYear()+"-"+n+"-"+r);var i=t.date;i.setDate(i.getDate()+0),a(".input-daterange .amd_return_date",e).datepicker("remove"),a(".input-daterange .amd_return_date",e).datepicker({language:st_params.locale,startDate:"+0d",format:s.data("tp-date-format"),autoclose:!0,todayHighlight:!0,weekStart:1}),a(".input-daterange .amd_return_date",e).datepicker("setDates",i),a(".input-daterange .amd_return_date",e).datepicker("setStartDate",i)}),a(".input-daterange .amd_return_date",e).datepicker({language:st_params.locale,startDate:"+0d",format:s.data("tp-date-format"),autoclose:!0,todayHighlight:!0,weekStart:1}).on("changeDate",function(e){var s=e.date.getMonth()+1;e.date.getMonth()+1<10&&(s="0"+s);var n=e.date.getDate();e.date.getDate()<10&&(n="0"+n),t=e.date.getFullYear()+"-"+s+"-"+n,a(this).parent().find(".amd-date-to").val(t);a(".input-daterange-return .tp-icon-return-del").length&&a(".input-daterange-return .tp-icon-return-del").remove(),a(".input-daterange-return").append('<i class="fa fa-times tp-icon-return-del"></i>')})}),a(document).on("click",".tp-icon-return-del",function(){a(".input-daterange .amd_return_date").val(""),a("input.amd-date-to").val(""),a(this).remove()}),a(".amd-form-passengers .amd_group_display").click(function(){a(this).parent().find(".amd-form-passengers-class").toggleClass("none"),a(this).find(".fa").toggleClass("fa-chevron-up"),a(this).find(".fa").toggleClass("fa-chevron-down")}),a(document).on("keyup mouseup",".amd-passengers-class input[name=adults]",function(){var t=a(this).closest(".amd-passengers-class");if(""==a(this).val());else{var e=a("input[name=infants]",t).val();""==e&&(e=0);var s=a("input[name=children]",t).val();""==s&&(s=0);var n=parseInt(e)+parseInt(s)+parseInt(a(this).val());if(n>9){var r=9-(parseInt(e)+parseInt(s));a(this).val(r),a(".amd-form-passengers-class .notice").html(a(".amd-form-passengers-class .notice").data("maxup")).fadeIn()}else a(".amd_group_display .quantity-passengers").text(n),a(".amd-form-passengers-class .notice").html("").fadeOut()}}),a(document).on("keyup mouseup",".amd-passengers-class input[name=children]",function(){var t=a(this).closest(".amd-passengers-class");if(""==a(this).val());else{var e=a("input[name=infants]",t).val();""==e&&(e=0);var s=a("input[name=adults]",t).val();""==s&&(s=0);var n=parseInt(e)+parseInt(s)+parseInt(a(this).val());if(n>9){var r=9-(parseInt(e)+parseInt(s));a(this).val(r),a(".amd-form-passengers-class .notice").html(a(".amd-form-passengers-class .notice").data("maxup")).fadeIn()}else a(".amd_group_display .quantity-passengers").text(n),a(".amd-form-passengers-class .notice").html("").fadeOut()}}),a(document).on("keyup mouseup",".amd-passengers-class input[name=infants]",function(){var t=a(this).closest(".amd-passengers-class");if(""==a(this).val());else{var e=a("input[name=adults]",t).val();""==e&&(e=0);var s=a("input[name=children]",t).val();""==s&&(s=0);var n=parseInt(e)+parseInt(s)+parseInt(a(this).val());if(n>9){var r=9-(parseInt(s)+parseInt(e));a(this).val(r),a(".amd-form-passengers-class .notice").html(a(".amd-form-passengers-class .notice").data("maxup")).fadeIn()}else parseInt(a(this).val())>e?(a(this).val(e),a(".amd-form-passengers-class .notice").html(a(".amd-form-passengers-class .notice").data("maxinf")).fadeIn()):(a(".amd_group_display .quantity-passengers").text(n),a(".amd-form-passengers-class .notice").html("").fadeOut())}}),a(document).on("focusout",".amd-passengers-class input[name=adults]",function(){""!=a(this).val()&&0!=a(this).val()||a(this).val(1)}),a(document).on("focusout",".amd-passengers-class input[name=children], .amd-passengers-class input[name=infants]",function(){""==a(this).val()&&a(this).val(0)});var e=!1;a(".amd-flight-location").each(function(){var t=a(this),s=t.closest(".amd-flight-wrapper");a(this).keyup(function(n){e=t,s.find(".st-location-id").remove();var r=t.attr("data-name"),i=(t.attr("data-locale"),t.val());i.length>=2&&a.getJSON("https://api.sandbox.amadeus.com/v1.2/airports/autocomplete?apikey="+st_amadeus.apikey+"&term="+i,function(e){if("object"==typeof e){var n="";n+='<select name="'+r+'" class="st-location-id st-hidden" tabindex="-1">',a.each(e,function(a,t){var e="";null!=t.label&&(e=t.label),n+='<option value="'+t.value+'">'+e+"</option>"}),n+="</select>",s.find(".st-location-id").remove(),s.append(n),n="",a("select option",s).prop("selected",!1),a("select option",s).each(function(t,e){var s=a(this).text();(function(a,t){return a.replace(new RegExp(t+"(?!([^<]+)?>)","gi"),'<span class="highlight">$&</span>')})(s,i).indexOf("</span>")>=0&&(n+='<div data-text="'+s+'" data-value="'+a(this).val()+'" class="option"><span class="label"><a href="#">'+s+' <i class="fa fa-plane"></i></a></div>')}),a(".option-wrapper").html(n).show(),t.caculatePosition(a(".option-wrapper"),t)}})}),t.caculatePosition=function(){if(e&&e.length){var t=a(".option-wrapper"),n=e,r=s.offset(),i=r.top+s.height(),o=r.left,d=n.outerWidth(),l=0;i-=l=a("#wpadminbar").length&&a(window).width()>=783?a("#wpadminbar").height():0;var p=99999,c="absolute";a("#search-dialog").length&&(c="fixed",i=i+l-a(window).scrollTop(),p=99999),t.css({position:c,top:i,left:o,width:d,"z-index":p})}},a(window).resize(function(){t.caculatePosition()})}),jQuery(function(a){a(document).ready(function(){a(document).on("click","#tab-amadeus_aff_flight13 .btn-amd-search-flight",function(t){t.preventDefault();var e=a(this).closest("form"),s=!1;""==a("#location_origin").val()?(s=!0,a("#location_origin").addClass("error")):a("#location_origin").removeClass("error"),""==a("#location_destination").val()?(s=!0,a("#location_destination").addClass("error")):a("#location_destination").removeClass("error"),""==a("#amd-field-depart-date").val()?(s=!0,a("#amd-field-depart-date").addClass("error")):a("#amd-field-depart-date").removeClass("error"),0==a('.amd-passengers-class input[name="adults"]').val()&&0==a('.amd-passengers-class input[name="children"]').val()&&0==a('.amd-passengers-class input[name="infants"]').val()?(s=!0,a(".amd_group_display").addClass("error")):a(".amd_group_display").removeClass("error"),s||e.submit()})})})});